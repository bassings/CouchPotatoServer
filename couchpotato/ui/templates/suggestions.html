{% extends "base.html" %}
{% block title %}Suggestions â€” CouchPotato{% endblock %}
{% block content %}
<div class="p-4 lg:p-8 fade-in" x-data="{ activeTab: 'charts' }">
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6">
    <div>
      <h1 class="text-xl font-semibold tracking-tight">Suggestions</h1>
      <p class="text-cp-muted text-xs mt-1">Discover new movies from your library suggestions and chart sources.</p>
    </div>
    <div class="flex gap-1 text-sm font-medium" role="tablist" aria-label="Suggestion categories">
      <button @click="activeTab = 'charts'" 
              role="tab"
              :aria-selected="activeTab === 'charts'"
              aria-controls="charts-grid"
              id="tab-charts"
              :class="activeTab === 'charts' ? 'bg-cp-accent text-black shadow-md' : 'bg-white/[0.06] text-cp-muted hover:text-cp-text hover:bg-white/[0.10]'" 
              class="px-4 py-2 rounded-lg transition-all">Charts</button>
      <button @click="activeTab = 'personal'" 
              role="tab"
              :aria-selected="activeTab === 'personal'"
              aria-controls="suggestions-grid"
              id="tab-personal"
              :class="activeTab === 'personal' ? 'bg-cp-accent text-black shadow-md' : 'bg-white/[0.06] text-cp-muted hover:text-cp-text hover:bg-white/[0.10]'" 
              class="px-4 py-2 rounded-lg transition-all">For You</button>
    </div>
  </div>

  <!-- Personal suggestions -->
  <div x-show="activeTab === 'personal'" 
       id="suggestions-grid"
       role="tabpanel"
       aria-labelledby="tab-personal"
       hx-get="{{ new_base }}partial/suggestions"
       hx-trigger="load"
       hx-indicator="#suggestions-loading"
       hx-swap="innerHTML">
    <!-- Loading skeleton -->
    <div id="suggestions-loading" class="htmx-indicator">
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3">
        {% for i in range(12) %}
        <div class="rounded-md overflow-hidden bg-cp-card border border-white/[0.05] animate-pulse">
          <div class="aspect-[2/3] bg-cp-surface"></div>
          <div class="p-2.5">
            <div class="h-3 bg-cp-surface rounded w-3/4 mb-2"></div>
            <div class="h-2 bg-cp-surface rounded w-1/3"></div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Charts (IMDB, Blu-ray, etc.) -->
  <div x-show="activeTab === 'charts'" 
       id="charts-grid"
       role="tabpanel"
       aria-labelledby="tab-charts"
       hx-get="{{ new_base }}partial/charts"
       hx-trigger="load"
       hx-indicator="#charts-loading"
       hx-swap="innerHTML">
    <!-- Loading skeleton -->
    <div id="charts-loading" class="htmx-indicator">
      <div class="mb-8">
        <div class="h-4 bg-cp-surface rounded w-32 mb-3 animate-pulse"></div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3">
          {% for i in range(12) %}
          <div class="rounded-md overflow-hidden bg-cp-card border border-white/[0.05] animate-pulse">
            <div class="aspect-[2/3] bg-cp-surface"></div>
            <div class="p-2.5">
              <div class="h-3 bg-cp-surface rounded w-3/4 mb-2"></div>
              <div class="h-2 bg-cp-surface rounded w-1/3"></div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
